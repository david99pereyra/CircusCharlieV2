/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package jgame.gradle.CircusCharlie;

import com.entropyinteractive.*;  //jgame

import jgame.gradle.CircusCharlie.ObjetosGraficos.Niveles.Nivel1;
import jgame.gradle.CircusCharlie.ObjetosGraficos.Niveles.Nivel2;

import java.awt.*;
import java.awt.event.*; //eventos
import java.util.*;
import java.text.*;

public class CircusCharlie extends JGame {
    private boolean level1 = false, level2 = true, level3 =false;
    Date dInit = new Date( ), dAhora;
    SimpleDateFormat ft = new SimpleDateFormat ("mm:ss");
    Camara cam;
    Fondo fondo;
    Charlie charlie;
    //Variables del level 1
    Nivel1 evento1;
    Charlie leon;
    //Variables del level 2
    Nivel2 evento2;
    //Variables del level 3

    public static void main(String[] args) {
        CircusCharlie game = new CircusCharlie();
        game.run(1.0 / 60.0);
        System.exit(0);
    }

    public CircusCharlie() {
        // call game constructor
        super("AppCamaracharlie ", 800, 600);
    }

    public void gameStartup() {
        Log.info(getClass().getSimpleName(), "Starting up game");
        Mundo m=Mundo.getInstance();
        charlie=new Charlie("imagenes/JuegoCircusCharlie/Generales/charlie.png");
        try{        
            if(level1){
                evento1 = new Nivel1(charlie, leon, fondo);
                charlie.setPISO(412);
                charlie.setPosition(174,charlie.getPISO());
                leon = new Charlie("imagenes/JuegoCircusCharlie/ImagenNivel1/leon.png");
                leon.setPISO(477);
                leon.setPosition(143, leon.getPISO());
                
                cam = new Camara(0,0);
                cam.setRegionVisible(getWidth(),480);
    
                fondo = new Fondo("imagenes/JuegoCircusCharlie/ImagenNivel1/FONDO.png");
                m.setLimitesMundo(fondo.getWidth(), fondo.getHeight());
                charlie.quieto();
                leon.quietoLeon();
            } //Aca va lo del nivel 1
            
            if(level2){ //Aca va lo del nivel 2
                evento2 = new Nivel2(charlie, fondo);
                charlie.setPISO(220);
                charlie.setPosition(174,charlie.getPISO());            
                cam =new Camara(0,-26);
                cam.setRegionVisible(getWidth(),480);
                fondo=new Fondo("imagenes/JuegoCircusCharlie/ImagenNivel2/FONDO_Nivel2.png");
                m.setLimitesMundo(fondo.getWidth(), fondo.getHeight());
                charlie.quieto();
            }

            if(level3){} //Aca va lo del nivel 3
        }catch(Exception ex){
            System.out.println("ERROR en gameStartup");
            ex.printStackTrace();
        }
    }
    
    public void gameUpdate(double delta) {
        if(level1){ //Aca va lo del nivel 1
            Keyboard keyboard = getKeyboard();
            if (keyboard.isKeyPressed(KeyEvent.VK_LEFT)){
                if(leon.getX() > 10 && Nivel1.llegoAMeta() == false){
                    charlie.left();
                    leon.leftLeon();
                }
            }
            if (keyboard.isKeyPressed(KeyEvent.VK_RIGHT)){
                if(leon.getX()+leon.getWidth()<fondo.getWidth() && Nivel1.llegoAMeta() == false){
                    charlie.right();
                    leon.rightLeon();
                }
            }
            // check the list of key events for a pressed escape key
            LinkedList < KeyEvent > keyEvents = keyboard.getEvents();
            for (KeyEvent event: keyEvents) {
                if ((event.getID() == KeyEvent.KEY_RELEASED)){
                    charlie.quieto();
                    leon.quietoLeon();
                }
                if ((event.getID() == KeyEvent.KEY_PRESSED) &&
                    (event.getKeyCode() == KeyEvent.VK_SPACE)) {
                    if(Nivel1.llegoAMeta() == false){
                        charlie.jump();
                        leon.jumpLeon();
                        FXPlayer.FX00.play();
                    }
                }
                if ((event.getID() == KeyEvent.KEY_PRESSED) &&
                    (event.getKeyCode() == KeyEvent.VK_ESCAPE)) {
                    FXPlayer.EVENTO1.stop();
                    stop();
                }
            }
            leon.update(delta);
            charlie.update(delta);
            cam.seguirPersonaje(charlie); ///la camara sigue al Personaje
            cam.seguirPersonaje(leon); 
            evento1.actualizar(delta, charlie, leon);
        } 
        
        if(level2){ //Aca va lo del nivel 2

            //Made in Joaquinho
            Keyboard keyboard = getKeyboard();
            if (keyboard.isKeyPressed(KeyEvent.VK_LEFT)){
                if(charlie.getX() > 10 && Nivel2.llegoAMeta() == false){
                    charlie.left();
                }
            }
            if (keyboard.isKeyPressed(KeyEvent.VK_RIGHT)){
                if(charlie.getX() + charlie.getWidth() < fondo.getWidth() && Nivel2.llegoAMeta() == false){
                    charlie.right();
                }
            }
            // check the list of key events for a pressed escape key
            LinkedList < KeyEvent > keyEvents = keyboard.getEvents();
            for (KeyEvent event: keyEvents) {
                if ((event.getID() == KeyEvent.KEY_RELEASED)){
                    charlie.quieto();
                }
                if ((event.getID() == KeyEvent.KEY_PRESSED) && (event.getKeyCode() == KeyEvent.VK_SPACE)) {
                    if(Nivel2.llegoAMeta() == false){
                        charlie.jump();
                        FXPlayer.FX00.play();
                    }
                }
                if ((event.getID() == KeyEvent.KEY_PRESSED) && (event.getKeyCode() == KeyEvent.VK_ESCAPE)) {
                    FXPlayer.EVENTO1.stop();
                    stop();
                }
                
            }
            evento2.actualizar(delta, charlie);
            charlie.update(delta);
            cam.seguirPersonaje(charlie); ///la camara sigue al Personaje
        } 

        if(level3){} //Aca va lo del nivel 3 
        //charlie.applyForce(gravedad);
    }

    public void gameDraw(Graphics2D g) {
        if(level1){} //Aca va lo del nivel 1
        if(level2){} //Aca va lo del nivel 2
        if(level3){} //Aca va lo del nivel 3
        g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

        Mundo m=Mundo.getInstance();

        g.translate(cam.getX(),cam.getY());

        fondo.display(g);
        m.display(g);

        // evento1.dibujar(g, charlie, leon);

        evento2.dibujar(g, charlie);

        g.translate(-cam.getX(),-cam.getY());
        g.setColor(Color.red);
        g.drawString("Tecla ESC = Fin del Juego ",490,20);
    }

    public void gameShutdown() {
       //Log.info(getClass().getSimpleName(), "Shutting down game");
    }
}